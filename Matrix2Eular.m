function angle = Matrix2Eular(R)
    q = zeros(1,4);
    q(1,1) = (R(1,1)+R(2,2)+R(3,3)+1.0)/4.0;
    q(1,2) = (R(1,1)-R(2,2)-R(3,3)+1.0)/4.0;
    q(1,3) = (-R(1,1)+R(2,2)-R(3,3)+1.0)/4.0;
    q(1,4) = (-R(1,1)-R(2,2)+R(3,3)+1.0)/4.0;
    if q(1,1) < 0.0
        q(1,1) = 0.0;
    end
    if q(1,2) < 0.0
        q(1,2) = 0.0;
    end
    if q(1,3) < 0.0
        q(1,3) = 0.0;
    end
    if q(1,4) < 0.0
        q(1,4) = 0.0;
    end
    for i = 1:4
        q(1,i) = sqrt(q(1,i));
    end
    if q(1,1) >= q(1,2) & q(1,1) >= q(1,3) & q(1,1) >= q(1,4)
        q(1,1) = 1.0*q(1,1);
        q(1,2) = sign(R(3,2)-R(2,3))*q(1,2);
        q(1,3) = sign(R(1,3)-R(3,1))*q(1,3);
        q(1,4) = sign(R(2,1)-R(1,2))*q(1,4);
    elseif q(1,2) >= q(1,1) & q(1,2) >= q(1,3) & q(1,2) >= q(1,4)
        q(1,1) = sign(R(3,2)-R(2,3))*q(1,1);
        q(1,2) = 1.0*q(1,2);
        q(1,3) = sign(R(2,1)+R(1,2))*q(1,3);
        q(1,4) = sign(R(1,3)+R(3,1))*q(1,4);
    elseif q(1,3) >= q(1,1) & q(1,3) >= q(1,2) & q(1,3) >= q(1,4)
        q(1,1) = sign(R(1,3)-R(3,1))*q(1,1);
        q(1,2) = sign(R(2,1)+R(1,2))*q(1,2);
        q(1,3) = 1.0*q(1,3);
        q(1,4) = sign(R(3,2)+R(2,3))*q(1,4);
    elseif q(1,4) >= q(1,1) & q(1,4) >= q(1,2) & q(1,4) >= q(1,3)
        q(1,1) = sign(R(2,1)-R(1,2))*q(1,1);
        q(1,2) = sign(R(1,3)+R(3,1))*q(1,2);
        q(1,3) = sign(R(3,2)+R(2,3))*q(1,3);
        q(1,4) = 1.0*q(1,4);
    end
    qn = norm(q);
    q = q./qn;
    angle = zeros(1,3);
    w = q(1,1); x = q(1,2); y = q(1,3); z = q(1,4);
    phi = atan2(2.0*(w*x+y*z), 1-2.0*(x*x+y*y));
    theta = asin(2.0*(w*y-z*x));
    psi = atan2(2.0*(w*z+x*y), 1-2.0*(y*y+z*z));
    angle(1,1) = phi*180/pi;
    angle(1,2) = theta*180/pi;
    angle(1,3) = psi*180/pi;
    angle
end

